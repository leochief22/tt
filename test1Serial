import tkinter as tk
import serial
import threading
import time

# Configura el puerto serial
arduino = serial.Serial('/dev/ttyACM0', 9600, timeout=1)
time.sleep(2)  # Espera que Arduino reinicie

def enviar_comando(cmd):
    arduino.write(f"{cmd}\n".encode())

def leer_serial():
    while True:
        if arduino.in_waiting > 0:
            respuesta = arduino.readline().decode().strip()
            if respuesta:
                estado_label.config(text=f"Arduino: {respuesta}")

def encender_led():
    enviar_comando("ON")

def apagar_led():
    enviar_comando("OFF")

root = tk.Tk()
root.title("Control LED con Arduino")

btn_on = tk.Button(root, text="Encender LED", command=encender_led, bg="green", fg="white", font=("Arial", 14))
btn_on.pack(pady=10, padx=20, fill='x')

btn_off = tk.Button(root, text="Apagar LED", command=apagar_led, bg="red", fg="white", font=("Arial", 14))
btn_off.pack(pady=10, padx=20, fill='x')

estado_label = tk.Label(root, text="Estado Arduino: ---", font=("Arial", 12))
estado_label.pack(pady=10)

# Hilo para leer serial sin bloquear la interfaz
hilo_lectura = threading.Thread(target=leer_serial, daemon=True)
hilo_lectura.start()

root.mainloop()
